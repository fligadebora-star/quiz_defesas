<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz - Sistema Imunit√°rio e Suplementos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1f3a 0%, #0d1929 100%);
            min-height: 100vh;
            padding: 20px;
            color: #f1f5f9;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            animation: slideDown 0.8s ease-out;
        }

        .premium-image {
            max-width: 100%;
            height: auto;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(56, 189, 248, 0.3);
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #38bdf8, #0ea5e9);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #cbd5e1;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .info-banner {
            background: rgba(56, 189, 248, 0.1);
            border-left: 4px solid #38bdf8;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            font-size: 0.95em;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #38bdf8, #0ea5e9);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(56, 189, 248, 0.3);
        }

        .btn-secondary {
            background: rgba(148, 163, 184, 0.2);
            color: #cbd5e1;
            border: 1px solid #475569;
        }

        .btn-secondary:hover {
            background: rgba(148, 163, 184, 0.3);
        }

        .btn-danger {
            background: rgba(239, 68, 68, 0.2);
            color: #fca5a5;
            border: 1px solid #dc2626;
        }

        .btn-danger:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        .quiz-section {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .quiz-section.active {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .question-card {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(56, 189, 248, 0.2);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
            backdrop-filter: blur(10px);
        }

        .question-number {
            color: #38bdf8;
            font-weight: 700;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .question-text {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid rgba(56, 189, 248, 0.2);
            border-radius: 8px;
            background: rgba(15, 23, 42, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.05em;
        }

        .option:hover {
            border-color: #38bdf8;
            background: rgba(56, 189, 248, 0.1);
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #38bdf8;
            background: rgba(56, 189, 248, 0.2);
        }

        .option.correct {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.2);
        }

        .option.incorrect {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.2);
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: rgba(16, 185, 129, 0.15);
            color: #86efac;
            border-left: 4px solid #10b981;
        }

        .feedback.incorrect {
            background: rgba(239, 68, 68, 0.15);
            color: #fca5a5;
            border-left: 4px solid #ef4444;
        }

        .product-link {
            color: #38bdf8;
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 1px dotted #38bdf8;
        }

        .product-link:hover {
            color: #0ea5e9;
        }

        .product-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .product-modal.show {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background: #1e293b;
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            border: 1px solid rgba(56, 189, 248, 0.2);
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-close {
            float: right;
            cursor: pointer;
            font-size: 2em;
            color: #cbd5e1;
        }

        .modal-close:hover {
            color: #ef4444;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
            gap: 15px;
        }

        .progress-bar {
            flex: 1;
            height: 8px;
            background: rgba(56, 189, 248, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #38bdf8, #0ea5e9);
            transition: width 0.5s ease;
        }

        .results {
            background: rgba(30, 41, 59, 0.8);
            border: 2px solid rgba(56, 189, 248, 0.3);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .score {
            font-size: 4em;
            font-weight: 700;
            background: linear-gradient(135deg, #38bdf8, #10b981);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 20px 0;
        }

        .discount-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            font-size: 1.3em;
            font-weight: 700;
            color: #1f2937;
        }

        .results-message {
            font-size: 1.3em;
            margin: 20px 0;
            line-height: 1.6;
        }

        .edit-section {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(56, 189, 248, 0.2);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            backdrop-filter: blur(10px);
        }

        .edit-label {
            color: #cbd5e1;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
            font-size: 0.9em;
        }

        .edit-input {
            width: 100%;
            padding: 12px;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(56, 189, 248, 0.2);
            border-radius: 8px;
            color: #f1f5f9;
            font-family: inherit;
            margin-bottom: 15px;
            font-size: 0.95em;
        }

        .edit-input:focus {
            outline: none;
            border-color: #38bdf8;
            box-shadow: 0 0 0 3px rgba(56, 189, 248, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #38bdf8;
        }

        .settings-toggle {
            background: rgba(148, 163, 184, 0.2);
            color: #cbd5e1;
            border: 1px solid #475569;
        }

        .settings-toggle:hover {
            background: rgba(148, 163, 184, 0.3);
        }

        .settings-section {
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(56, 189, 248, 0.2);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            backdrop-filter: blur(10px);
        }

        .settings-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            color: #38bdf8;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .question-text {
                font-size: 1.1em;
            }

            .controls {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .score {
                font-size: 2.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <img src="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/4b483110-a690-4316-9e5d-ae3237642289.png" alt="Sistema Imunit√°rio Premium" class="premium-image">
            <h1>Sistema Imunit√°rio & Defesas</h1>
            <p class="subtitle">Quiz Interativo - Educa√ß√£o Farmac√™utica em Suplementa√ß√£o</p>
            <div class="info-banner">
                ‚ÑπÔ∏è Responda corretamente a todas as 20 quest√µes e ganhe um vale de desconto exclusivo!
            </div>
        </div>

        <!-- CONTROLS -->
        <div class="controls">
            <button class="btn btn-primary" onclick="startQuiz()" id="startBtn">Iniciar Quiz</button>
            <button class="btn btn-secondary settings-toggle" onclick="toggleSettings()" id="editBtn" style="display: none;">‚öôÔ∏è Editar Conte√∫do</button>
            <button class="btn btn-secondary" onclick="toggleDiscountOption()" id="discountBtn" style="display: none;">üí≥ Gerir Desconto</button>
        </div>

        <!-- SETTINGS SECTION -->
        <div class="settings-section" id="settingsSection" style="display: none;">
            <div class="settings-title">üìù Editar Quiz e Conte√∫do</div>
            <div id="editableQuestions"></div>
            <button class="btn btn-primary" onclick="saveEdits()" style="margin-top: 20px;">Guardar Altera√ß√µes</button>
            <button class="btn btn-secondary" onclick="toggleSettings()" style="margin-top: 10px;">Fechar</button>
        </div>

        <!-- DISCOUNT SETTINGS -->
        <div class="settings-section" id="discountSection" style="display: none;">
            <div class="settings-title">üí≥ Configura√ß√µes de Desconto</div>
            <div class="checkbox-group">
                <input type="checkbox" id="enableDiscount" checked>
                <label for="enableDiscount" style="margin: 0; cursor: pointer;">Ativar vale de 10% de desconto</label>
            </div>
            <label class="edit-label">C√≥digo de Desconto (opcional):</label>
            <input type="text" class="edit-input" id="discountCode" placeholder="Ex: SAUDE2024" value="SAUDE2024">
            <label class="edit-label">URL do Vale de Desconto:</label>
            <input type="text" class="edit-input" id="discountUrl" placeholder="https://seu-site.com/vale" value="">
            <button class="btn btn-primary" onclick="saveDiscountSettings()" style="margin-top: 20px;">Guardar Configura√ß√µes</button>
            <button class="btn btn-secondary" onclick="toggleDiscountOption()" style="margin-top: 10px;">Fechar</button>
        </div>

        <!-- QUIZ SECTION -->
        <div class="quiz-section active" id="quizStartSection">
            <div class="question-card" style="text-align: center; padding: 60px 30px;">
                <h2>Bem-vindo ao Quiz de Imunidade!</h2>
                <p style="margin-top: 20px; font-size: 1.1em; color: #cbd5e1;">
                    Teste os seus conhecimentos sobre o sistema imunit√°rio e os suplementos mais eficazes para refor√ßar as suas defesas. 
                    <br><br>
                    Clique em "Iniciar Quiz" para come√ßar!
                </p>
            </div>
        </div>

        <!-- QUIZ QUESTIONS -->
        <div class="quiz-section" id="quizSection"></div>

        <!-- RESULTS SECTION -->
        <div class="quiz-section" id="resultsSection">
            <div class="results">
                <h2>Parab√©ns! üéâ</h2>
                <div class="score" id="scoreDisplay">0/20</div>
                <div class="results-message" id="resultMessage"></div>
                <div class="discount-badge" id="discountBadge" style="display: none;">
                    üéÅ Vale de 10% de Desconto Desbloqueado!
                    <br><small style="font-size: 0.7em; margin-top: 10px; display: block;">C√≥digo: <span id="discountCodeDisplay">SAUDE2024</span></small>
                </div>
                <button class="btn btn-primary" onclick="restartQuiz()" style="margin-top: 30px;">Repetir Quiz</button>
            </div>
        </div>
    </div>

    <!-- PRODUCT MODAL -->
    <div class="product-modal" id="productModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeProductModal()">&times;</span>
            <div id="productContent"></div>
            <input type="text" class="edit-input" id="productLink" placeholder="Cole o link do produto aqui" style="margin-top: 20px;">
            <button class="btn btn-primary" onclick="setProductLink()" style="width: 100%; margin-top: 10px;">Aplicar Link</button>
        </div>
    </div>

    <script>
        // Default quiz data
        const defaultQuestions = [
            {
                question: "Qual √© a principal fun√ß√£o da vitamina D no sistema imunit√°rio?",
                options: [
                    "Produzir hemoglobina",
                    "Regular as respostas imunit√°rias (inata e adaptativa)",
                    "Acelerar o metabolismo",
                    "Fortalecer os ossos apenas"
                ],
                correct: 1,
                feedback: "A vitamina D tem um papel crucial na regula√ß√£o da resposta imunit√°ria. Na imunidade inata, estimula os mon√≥citos e macr√≥fagos. Na imunidade adaptativa, controla a libera√ß√£o de subst√¢ncias inflamat√≥rias.",
                supplement: "Vitamina D3"
            },
            {
                question: "O zinco √© essencial para qual c√©lula do sistema imunit√°rio?",
                options: [
                    "Hem√°cias",
                    "C√©lulas T (linf√≥citos T)",
                    "Plaquetas",
                    "Eritr√≥citos"
                ],
                correct: 1,
                feedback: "O zinco √© fundamental para o desenvolvimento, comunica√ß√£o e fun√ß√£o das c√©lulas T. A sua defici√™ncia afeta significativamente a capacidade imunit√°ria.",
                supplement: "Zinco Bisglicinato"
            },
            {
                question: "Quantas horas ap√≥s o in√≠cio dos sintomas deve tomar zinco para m√°xima efic√°cia?",
                options: [
                    "48 horas",
                    "72 horas",
                    "24 horas",
                    "1 semana"
                ],
                correct: 2,
                feedback: "A investiga√ß√£o cient√≠fica (BMJ Open, 2021) demonstra que o zinco √© mais eficaz quando tomado nas primeiras 24 horas ap√≥s o in√≠cio dos sintomas.",
                supplement: "Zinco"
            },
            {
                question: "Qual √© a dose di√°ria recomendada de vitamina C para adultos?",
                options: [
                    "5-10 mg",
                    "50-100 mg",
                    "75-90 mg",
                    "500-1000 mg"
                ],
                correct: 2,
                feedback: "A recomenda√ß√£o di√°ria √© de 75-90 mg. Por√©m, para suplementa√ß√£o, muitas vezes usa-se 500-1000 mg/dia em doses divididas.",
                supplement: "Vitamina C"
            },
            {
                question: "O que caracteriza a imunidade inata?",
                options: [
                    "Aquela que adquirimos ao longo da vida",
                    "Aquela com a qual j√° nascemos",
                    "A que precisa de vacina√ß√£o",
                    "A que diminui com a idade"
                ],
                correct: 1,
                feedback: "A imunidade inata √© cong√©nita - aquela com a qual nascemos e que atua imediatamente contra patog√©nios. Diferentes da imunidade adaptativa que desenvolvemos ao longo da vida.",
                supplement: "Vitamina D"
            },
            {
                question: "Qual √© a dose m√°xima segura de vitamina D para adultos?",
                options: [
                    "1000 IU",
                    "2000 IU",
                    "4000 IU",
                    "6000 IU"
                ],
                correct: 2,
                feedback: "A dose m√°xima segura √© de 4000 IU/dia. Doses di√°rias recomendadas variam de 600-2000 IU, dependendo das necessidades individuais.",
                supplement: "Vitamina D"
            },
            {
                question: "A vitamina C funciona como antioxidante ao proteger contra...",
                options: [
                    "Bact√©rias",
                    "Radicais livres e stress oxidativo",
                    "V√≠rus",
                    "Fungos"
                ],
                correct: 1,
                feedback: "A vitamina C √© um poderoso antioxidante que protege contra danos induzidos pelo stress oxidativo, relacionado a v√°rias doen√ßas cardiovasculares e renais.",
                supplement: "Vitamina C"
            },
            {
                question: "Qual √© a dose di√°ria recomendada de zinco para mulheres?",
                options: [
                    "5 mg",
                    "8 mg",
                    "15 mg",
                    "25 mg"
                ],
                correct: 1,
                feedback: "A dose di√°ria recomendada √© 8 mg para mulheres adultas e 11 mg para homens. A dose m√°xima segura √© 40 mg/dia.",
                supplement: "Zinco"
            },
            {
                question: "Qual suplemento mostrou reduzir a dura√ß√£o da gripe em m√©dia 4 dias?",
                options: [
                    "Pr√≥polis",
                    "Gengibre",
                    "Sabugueiro (Sambucus nigra)",
                    "Alca√ßuz"
                ],
                correct: 2,
                feedback: "Estudos cl√≠nicos publicados no Journal of International Medical Research (2004) demonstram que o sabugueiro pode reduzir os sintomas de gripe em aproximadamente 4 dias.",
                supplement: "Sabugueiro"
            },
            {
                question: "A curcumina (de c√∫rcuma) modula principalmente...",
                options: [
                    "A absor√ß√£o de nutrientes",
                    "A inflama√ß√£o e o equil√≠brio imunit√°rio",
                    "A fun√ß√£o digestiva",
                    "A sensibilidade ao paladar"
                ],
                correct: 1,
                feedback: "A curcumina tem propriedades imunomoduladoras comprovadas, reduzindo a inflama√ß√£o e promovendo equil√≠brio no sistema imunit√°rio (Journal of Clinical Immunology, 2015).",
                supplement: "Curcumina + Piperina"
            },
            {
                question: "Para m√°xima absor√ß√£o, a curcumina deve ser combinada com...",
                options: [
                    "Gengibre",
                    "Piperina (pimenta preta)",
                    "Mel",
                    "√ìleo de coco"
                ],
                correct: 1,
                feedback: "A piperina aumenta significativamente a biodisponibilidade da curcumina, potenciando os seus efeitos imunomoduladoras. Este √© o motivo por forma est√£o frequentemente combinadas.",
                supplement: "Curcumina + Piperina"
            },
            {
                question: "Os probi√≥ticos atuam principalmente no sistema imunit√°rio atrav√©s de...",
                options: [
                    "Aumento da ingest√£o cal√≥rica",
                    "Melhoria da barreira intestinal e aumento de IgA",
                    "Bloqueio de nutrientes",
                    "Aumento do cortisol"
                ],
                correct: 1,
                feedback: "Os probi√≥ticos melhoram a sa√∫de intestinal, aumentam a atividade fagocit√°ria e elevam os n√≠veis de IgA (imunoglobulina A) no intestino, fundamentais para a imunidade.",
                supplement: "Probi√≥ticos"
            },
            {
                question: "Qual √© a dose m√≠nima recomendada de probi√≥ticos para efic√°cia?",
                options: [
                    "1 bili√£o de bact√©rias",
                    "5 bili√µes de bact√©rias",
                    "10 bili√µes de bact√©rias",
                    "50 bili√µes de bact√©rias"
                ],
                correct: 2,
                feedback: "Recomenda-se um m√≠nimo de 10 bili√µes de bact√©rias (10 CFU) por suplemento para garantir efic√°cia cl√≠nica demonstrada.",
                supplement: "Probi√≥ticos"
            },
            {
                question: "A echinacea estimula principalmente...",
                options: [
                    "A absor√ß√£o intestinal",
                    "A fagocitose e atividade de c√©lulas NK",
                    "A s√≠ntese de hemoglobina",
                    "A coagula√ß√£o do sangue"
                ],
                correct: 1,
                feedback: "A echinacea estimula a fagocitose (destrui√ß√£o de patog√©nios) e aumenta a atividade das c√©lulas NK (Natural Killer), melhorando a resposta imunit√°ria inata.",
                supplement: "Echinacea"
            },
            {
                question: "Estudos mostram que a echinacea pode melhorar a fun√ß√£o imunit√°ria em at√©...",
                options: [
                    "25%",
                    "45%",
                    "58%",
                    "75%"
                ],
                correct: 2,
                feedback: "Uma meta-an√°lise de 14 estudos cl√≠nicos concluiu que a echinacea pode melhorar a fun√ß√£o imunit√°ria em at√© 58% e fortalecer o corpo durante o stress em 36 horas.",
                supplement: "Echinacea"
            },
            {
                question: "Qual mineral protege especificamente as barreiras de tecido do corpo?",
                options: [
                    "Magn√©sio",
                    "C√°lcio",
                    "Zinco",
                    "Ferro"
                ],
                correct: 2,
                feedback: "O zinco protege as barreiras de tecido (epitelial e mucosa) do corpo, ajudando a prevenir a entrada de agentes patog√©nios como bact√©rias e v√≠rus.",
                supplement: "Zinco"
            },
            {
                question: "A vitamina A fortalece principalmente...",
                options: [
                    "Os ossos",
                    "Os m√∫sculos",
                    "As membranas mucosas (nariz e garganta)",
                    "O colesterol"
                ],
                correct: 2,
                feedback: "A vitamina A ajuda a fortalecer as membranas mucosas do nariz e da garganta, primeira linha de defesa contra patog√©nios. Tamb√©m apoia a fun√ß√£o do timo.",
                supplement: "Vitamina A"
            },
            {
                question: "A defici√™ncia de zinco pode resultar em risco aumentado de...",
                options: [
                    "Osteoporose",
                    "Infe√ß√µes respirat√≥rias e pneumonia",
                    "Diabetes",
                    "Colesterol alto"
                ],
                correct: 1,
                feedback: "A defici√™ncia de zinco afeta significativamente a capacidade do sistema imunit√°rio funcionar adequadamente, aumentando o risco de infe√ß√µes, incluindo pneumonia.",
                supplement: "Zinco"
            },
            {
                question: "Qual suplemento cont√©m propriedades anticancer√≠genas e imunoestimuladoras reconhecidas?",
                options: [
                    "Mel puro",
                    "Pr√≥polis e espirulina",
                    "Ch√° verde apenas",
                    "√Ågua desionizada"
                ],
                correct: 1,
                feedback: "Pr√≥polis e espirulina t√™m efeitos anticancer√≠genos, antibacterianos e imunoestimuladoras documentados em m√∫ltiplos estudos cient√≠ficos.",
                supplement: "Pr√≥polis e Espirulina"
            }
        ];

          let questions = [...defaultQuestions];
        let currentQuestion = 0;
        let score = 0;
        let answered = [];
        let enableDiscount = true;
        let discountCode = "LIGA_IMUN_QUIZ";
        let isAdmin = false;

        // Verificar se o utilizador √© administrador (via URL)
        function checkAdminAccess() {
            const urlParams = new URLSearchParams(window.location.search);
            const adminKey = urlParams.get('admin');
            if (adminKey === 'fligacol2023') {
                isAdmin = true;
                const editBtn = document.getElementById('editBtn');
                const discountBtn = document.getElementById('discountBtn');
                if (editBtn) editBtn.style.display = 'inline-block';
                if (discountBtn) discountBtn.style.display = 'inline-block';
            }
        }

        // Chamar ao carregar a p√°gina
        checkAdminAccess();

        // Initialize quiz
        function initQuiz() {

        // Initialize quiz
        function initQuiz() {
            answered = new Array(questions.length).fill(null);
            currentQuestion = 0;
            score = 0;
            loadQuizSection();
        }

        function startQuiz() {
            document.getElementById('quizStartSection').classList.remove('active');
            document.getElementById('quizSection').classList.add('active');
            initQuiz();
        }

        function loadQuizSection() {
            const quizSection = document.getElementById('quizSection');
            quizSection.innerHTML = '';

            questions.forEach((q, idx) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.innerHTML = `
                    <div class="question-number">Pergunta ${idx + 1} de ${questions.length}</div>
                    <div class="question-text">${q.question}</div>
                    <div class="options">
                        ${q.options.map((opt, optIdx) => `
                            <div class="option" onclick="selectOption(${idx}, ${optIdx})" id="opt-${idx}-${optIdx}">
                                ${String.fromCharCode(65 + optIdx)}. ${opt}
                            </div>
                        `).join('')}
                    </div>
                    <div class="feedback" id="feedback-${idx}"></div>
                `;
                quizSection.appendChild(card);
            });

            const nav = document.createElement('div');
            nav.className = 'navigation';
            nav.innerHTML = `
                <button class="btn btn-secondary" onclick="previousQuestion()" id="prevBtn" style="display: none;">‚Üê Anterior</button>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 5%;"></div>
                </div>
                <button class="btn btn-primary" onclick="nextQuestion()" id="nextBtn">Pr√≥xima ‚Üí</button>
            `;
            quizSection.appendChild(nav);

            showQuestion(0);
        }

        function showQuestion(idx) {
            document.querySelectorAll('.question-card').forEach((card, i) => {
                card.style.display = i === idx ? 'block' : 'none';
            });

            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const progressFill = document.getElementById('progressFill');

            prevBtn.style.display = idx > 0 ? 'block' : 'none';
            nextBtn.textContent = idx === questions.length - 1 ? 'Terminar Quiz ‚úì' : 'Pr√≥xima ‚Üí';
            progressFill.style.width = ((idx + 1) / questions.length * 100) + '%';

            if (answered[idx] !== null) {
                const selected = answered[idx];
                document.getElementById(`opt-${idx}-${selected}`).classList.add('selected');
            }
        }

        function selectOption(qIdx, optIdx) {
            answered[qIdx] = optIdx;
            const question = questions[qIdx];
            const isCorrect = optIdx === question.correct;

            const option = document.getElementById(`opt-${qIdx}-${optIdx}`);
            option.classList.add('selected');

            const feedback = document.getElementById(`feedback-${qIdx}`);
            feedback.textContent = question.feedback;
            feedback.classList.add('show', isCorrect ? 'correct' : 'incorrect');

            if (isCorrect && !answered[qIdx + 1]) {
                score++;
            }

            setTimeout(() => {
                if (qIdx < questions.length - 1) {
                    nextQuestion();
                }
            }, 2000);
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                finishQuiz();
            }
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        function finishQuiz() {
            document.getElementById('quizSection').classList.remove('active');
            document.getElementById('resultsSection').classList.add('active');

            const scorePercentage = Math.round((score / questions.length) * 100);
            document.getElementById('scoreDisplay').textContent = `${score}/${questions.length}`;

            let message = '';
            if (scorePercentage === 100) {
                message = "Excelente! Voc√™ √© um especialista em suplementa√ß√£o e imunidade! üåü";
            } else if (scorePercentage >= 80) {
                message = "Muito bom! Demonstra s√≥lidos conhecimentos sobre defesas e suplementos.";
            } else if (scorePercentage >= 60) {
                message = "Bom desempenho! Continue a aprender sobre nutri√ß√£o e imunidade.";
            } else {
                message = "Continue estudando! H√° muito para descobrir sobre o sistema imunit√°rio.";
            }

            document.getElementById('resultMessage').textContent = message;

            const discountBadge = document.getElementById('discountBadge');
            if (enableDiscount && score === questions.length) {
                discountBadge.style.display = 'block';
                document.getElementById('discountCodeDisplay').textContent = discountCode;
            } else {
                discountBadge.style.display = 'none';
            }
        }

        function restartQuiz() {
            document.getElementById('resultsSection').classList.remove('active');
            document.getElementById('quizStartSection').classList.add('active');
        }

        function toggleSettings() {
            const section = document.getElementById('settingsSection');
            section.style.display = section.style.display === 'none' ? 'block' : 'none';

            if (section.style.display === 'block') {
                const editableDiv = document.getElementById('editableQuestions');
                editableDiv.innerHTML = '';

                questions.forEach((q, idx) => {
                    const qEdit = document.createElement('div');
                    qEdit.className = 'edit-section';
                    qEdit.innerHTML = `
                        <h4 style="color: #38bdf8; margin-bottom: 15px;">Pergunta ${idx + 1}</h4>
                        <label class="edit-label">Texto da Pergunta:</label>
                        <input type="text" class="edit-input" id="q-text-${idx}" value="${q.question}">
                        ${q.options.map((opt, optIdx) => `
                            <label class="edit-label">Op√ß√£o ${String.fromCharCode(65 + optIdx)}:</label>
                            <input type="text" class="edit-input" id="q-opt-${idx}-${optIdx}" value="${opt}">
                        `).join('')}
                        <label class="edit-label">Feedback/Resposta Correta:</label>
                        <textarea class="edit-input" id="q-feedback-${idx}" style="min-height: 80px;">${q.feedback}</textarea>
                        <label class="edit-label">Suplemento Associado:</label>
                        <input type="text" class="edit-input" id="q-supplement-${idx}" value="${q.supplement}">
                    `;
                    editableDiv.appendChild(qEdit);
                });
            }
        }

        function saveEdits() {
            questions.forEach((q, idx) => {
                q.question = document.getElementById(`q-text-${idx}`).value;
                q.options.forEach((_, optIdx) => {
                    q.options[optIdx] = document.getElementById(`q-opt-${idx}-${optIdx}`).value;
                });
                q.feedback = document.getElementById(`q-feedback-${idx}`).value;
                q.supplement = document.getElementById(`q-supplement-${idx}`).value;
            });

            alert('‚úì Altera√ß√µes guardadas com sucesso!');
            toggleSettings();
        }

        function toggleDiscountOption() {
            const section = document.getElementById('discountSection');
            section.style.display = section.style.display === 'none' ? 'block' : 'none';

            if (section.style.display === 'block') {
                document.getElementById('enableDiscount').checked = enableDiscount;
                document.getElementById('discountCode').value = discountCode;
            }
        }

        function saveDiscountSettings() {
            enableDiscount = document.getElementById('enableDiscount').checked;
            discountCode = document.getElementById('discountCode').value;
            alert('‚úì Configura√ß√µes de desconto guardadas!');
            toggleDiscountOption();
        }

        // Product modal functions
        let currentProductQuestion = null;

        function openProductModal(qIdx) {
            currentProductQuestion = qIdx;
            const product = questions[qIdx].supplement;
            document.getElementById('productContent').innerHTML = `
                <h3 style="color: #38bdf8; margin-bottom: 15px;">Adicionar Link do Produto</h3>
                <p style="color: #cbd5e1; margin-bottom: 15px;">Suplemento: <strong>${product}</strong></p>
                <p style="color: #cbd5e1; font-size: 0.9em;">Cole o link para o produto no seu site ou loja online.</p>
            `;
            document.getElementById('productModal').classList.add('show');
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.remove('show');
        }

        function setProductLink() {
            const link = document.getElementById('productLink').value;
            if (link) {
                // Store link in question data
                alert('‚úì Link do produto adicionado com sucesso!');
                closeProductModal();
            } else {
                alert('Por favor, insira um URL v√°lido');
            }
        }
    </script>
</body>
</html>

